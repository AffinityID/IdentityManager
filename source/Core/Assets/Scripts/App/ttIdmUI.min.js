(function(n){function i(){var n=this,t,i;n.clear=function(){t=null;i=null};Object.defineProperty(this,"message",{get:function(){return i},set:function(t){n.clear();i=t}});Object.defineProperty(this,"errors",{get:function(){return t},set:function(i){n.clear();t=i instanceof Array?i:[i]}});n.messageHandler=function(t){n.message=t};n.errorHandler=function(t){n.errors=t};n.createMessageHandler=function(t){return function(){n.message=t}};n.createErrorHandler=function(t){return function(i){n.errors=i||t}}}function r(n,t){n.when("/",{controller:"HomeCtrl",templateUrl:t+"/assets/Templates.home.html"}).when("/users/list/:filter?/:page?",{controller:"ListUsersCtrl",resolve:{api:"idmUsers"},templateUrl:t+"/assets/Templates.users.list.html"}).when("/users/create",{controller:"NewUserCtrl",resolve:{api:"idmUsers"},templateUrl:t+"/assets/Templates.users.new.html"}).when("/users/edit/:subject",{controller:"EditUserCtrl",resolve:{api:"idmUsers"},templateUrl:t+"/assets/Templates.users.edit.html"}).otherwise({redirectTo:"/"})}function u(n){return{restrict:"E",templateUrl:n+"/assets/Templates.modal.html",replace:!0,transclude:!0,scope:{id:"@",action:"@"},link:function(n,t){t.id=n.id.trim();t.find(".btn-primary.confirm").on("click",function(){t.trigger("confirm")})}}}function f(){return{restrict:"A",link:function(n,t,i){var u=!0,r=null;t.on("click",function(n){if(u&&(n.preventDefault(),$(i.ttConfirmClick).modal("show"),!r)){r=function(){$(this).off("confirm");u=!1;t.trigger("click")};$(i.ttConfirmClick).on("confirm",r)}})}}}function e(n){return{restrict:"E",scope:{model:"=message"},templateUrl:n+"/assets/Templates.message.html",link:function(){}}}function o(n,t){n.model={};t.then(function(){n.model.username=t.data.currentUser.username;n.model.links=t.links})}function s(n){n.model={}}function h(n,t,i,r,u){var e={message:null,users:null,pager:null,waiting:!0,filter:r.filter,page:r.page||1},f,o;n.model=e;n.search=function(n){var t="/list";n&&(t+="/"+n);u.url(t)};f=10;o=(e.page-1)*f;t.getUsers(e.filter,o,f).then(function(t){n.model.waiting=!1;n.model.users=t.data.users;t.data.users&&t.data.users.length&&(n.model.pager=new i(t.data,f))},function(t){n.model.message=t;n.model.waiting=!1})}function c(n,t){var r=new i;n.feedback=r;n.model={};n.create=function(i,u,f){if(u!==f){r.errors="Password and Confirm do not match.";return}t.createUser(i,u).then(function(t){n.model.last=t;r.message="Create Success"},r.errorHandler)}}function l(n,t,r){function f(){return t.getUser(r.subject).then(function(t){n.model.user=t},u.errorHandler)}var u=new i;n.feedback=u;n.model={};f();n.setPassword=function(n,i){n.data.password===i?t.setPassword(n).then(function(){u.message="Password Changed"},u.errorHandler):u.errors="Password and Confirmation do not match"};n.setEmail=function(n){t.setEmail(n).then(u.createMessageHandler("Email Changed"),u.errorHandler)};n.setPhone=function(n){t.setPhone(n).then(u.createMessageHandler("Phone Changed"),u.errorHandler)};n.addClaim=function(n,i){t.addClaim(n,i).then(function(){u.message="Claim Added";f()},u.errorHandler)};n.removeClaim=function(i){t.removeClaim(i).then(function(){u.message="Claim Removed";f().then(function(){n.model.claim=i.data})},u.errorHandler)};n.deleteUser=function(i){t.deleteUser(i).then(function(){u.message="User Deleted";n.model.user=null},u.errorHandler)}}var t=n.module("ttIdmUI",["ngRoute","ttIdm"]);r.$inject=["$routeProvider","PathBase"];t.config(r);u.$inject=["PathBase"];t.directive("ttPrompt",u);f.$inject=[];t.directive("ttConfirmClick",f);e.$inject=["PathBase"];t.directive("idmMessage",e);o.$inject=["$scope","idmApi"];t.controller("LayoutCtrl",o);s.$inject=["$scope"];t.controller("HomeCtrl",s);h.$inject=["$scope","idmUsers","idmPager","$routeParams","$location"];t.controller("ListUsersCtrl",h);c.$inject=["$scope","idmUsers"];t.controller("NewUserCtrl",c);l.$inject=["$scope","idmUsers","$routeParams"];t.controller("EditUserCtrl",l)})(angular);
/*
//# sourceMappingURL=ttIdmUI.min.js.map
*/