(function(n){function i(n,t,i){var r;this.start=function(){var u=t.defer();return r?u.resolve(r):n.get(i+"/api").then(function(n){r=n.data;u.resolve(r)},function(){u.reject("Error loading API")}),u.promise}}function r(n,t){var i={username:"Admin"};this.user=i;t.start().then(function(t){n.get(t.currentUser).then(function(n){n.data.username&&(i.username=n.data.username)})})}function u(n,t,i){function u(){}function f(n){return n.data}function r(n){return n=n||"Unexpected Error",function(t){t.data.exceptionMessage&&i.error(t.data.exceptionMessage);throw t.data.errors||t.data.message||n;}}this.getUsers=function(i,u,e){return n.get(t+"/api/users",{params:{filter:i,start:u,count:e}}).then(f,r("Error Getting Users"))};this.getUser=function(i){return n.get(t+"/api/users/"+encodeURIComponent(i)).then(f,r("Error Getting User"))};this.createUser=function(i,u){return n.post(t+"/api/users",{username:i,password:u}).then(f,r("Error Creating User"))};this.deleteUser=function(i){return n.delete(t+"/api/users/"+encodeURIComponent(i)).then(u,r("Error Deleting User"))};this.setPassword=function(i,f){return n.put(t+"/api/users/"+encodeURIComponent(i)+"/password",{password:f}).then(u,r("Error Setting Password"))};this.setEmail=function(i,f){return n.put(t+"/api/users/"+encodeURIComponent(i)+"/email",{email:f}).then(u,r("Error Setting Email"))};this.setPhone=function(i,f){return n.put(t+"/api/users/"+encodeURIComponent(i)+"/phone",{phone:f}).then(u,r("Error Setting Phone"))};this.addClaim=function(i,f,e){return n.post(t+"/api/users/"+encodeURIComponent(i)+"/claims",{type:f,value:e}).then(u,r("Error Adding Claim"))};this.removeClaim=function(i,f,e){return n.delete(t+"/api/users/"+encodeURIComponent(i)+"/claims/"+encodeURIComponent(f)+"/"+encodeURIComponent(e)).then(u,r("Error Removing Claim"))}}var t=n.module("ttIdm",[]);i.$inject=["$http","$q","PathBase"];t.service("idmApi",i);r.$inject=["$http","idmApi"];t.service("idmCurrentUser",r);u.$inject=["$http","PathBase","$log"];t.service("idmUsers",u)})(angular),function(n){function i(){var n=this,t,i;n.clear=function(){t=null;i=null};Object.defineProperty(this,"message",{get:function(){return i},set:function(t){n.clear();i=t}});Object.defineProperty(this,"errors",{get:function(){return t},set:function(i){n.clear();t=i instanceof Array?i:[i]}});n.messageHandler=function(t){n.message=t};n.errorHandler=function(t){n.errors=t};n.createMessageHandler=function(t){return function(){n.message=t}};n.createErrorHandler=function(t){return function(i){n.errors=i||t}}}function r(n,t){n.when("/",{controller:"HomeCtrl",templateUrl:t+"/assets/Templates.home.html"}).when("/list/:filter?/:page?",{controller:"ListUsersCtrl",templateUrl:t+"/assets/Templates.users.list.html"}).when("/create",{controller:"NewUserCtrl",templateUrl:t+"/assets/Templates.users.new.html"}).when("/edit/:subject",{controller:"EditUserCtrl",templateUrl:t+"/assets/Templates.users.edit.html"}).otherwise({redirectTo:"/"})}function u(n){return{restrict:"E",scope:{model:"=message"},templateUrl:n+"/assets/Templates.message.html",link:function(){}}}function f(n,t){n.model=t.user}function e(n){n.model={}}function o(n,t,i,r,u){function f(n,t,r,u){this.text=i.trustAsHtml(n+"");this.page=t;this.enabled=r;this.current=u}function s(n,t,i){var r,s,h,e;this.start=n.start;this.count=n.count;this.total=n.total;this.pageSize=t;this.filter=i;this.totalPages=Math.ceil(this.total/t);this.currentPage=this.start/t+1;this.canPrev=this.currentPage>1;this.canNext=this.currentPage<this.totalPages;this.buttons=[];var u=7,c=10,o=1;for(this.currentPage>Math.floor(u/2)&&(o=this.currentPage-Math.floor(u/2)),r=o+u-1,r>=this.totalPages&&(r=this.totalPages),this.totalPages>u&&r-o+1<u&&(o=r-u+1),s=this.currentPage-c,s<1&&(s=1),h=this.currentPage+c,h>this.totalPages&&(h=this.totalPages),this.buttons.push(new f("<strong>&lt;&lt;<\/strong>",1,r>u)),this.buttons.push(new f("<strong>&lt;<\/strong>",s,r>u)),e=o;e<=r;e++)this.buttons.push(new f(e,e,!0,e===this.currentPage));this.buttons.push(new f("<strong>&gt;<\/strong>",h,r<this.totalPages));this.buttons.push(new f("<strong>&gt;&gt;<\/strong>",this.totalPages,r<this.totalPages))}var e;n.model={};n.search=function(n){var t="/list";n&&(t+="/"+n);u.url(t)};e=r.filter;n.model.message=null;n.model.filter=e;n.model.users=null;n.model.pager=null;n.model.waiting=!0;var o=10,h=r.page||1,c=(h-1)*o;t.getUsers(e,c,o).then(function(t){n.model.waiting=!1;n.model.users=t.users;t.users&&t.users.length&&(n.model.pager=new s(t,o,e))},function(t){n.model.message=t;n.model.waiting=!1})}function s(n,t){var r=new i;n.feedback=r;n.model={};n.create=function(i,u){t.createUser(i,u).then(function(t){n.model.last=t.subject;r.message="Create Success"},r.errorHandler)}}function h(n,t,r){function f(){t.getUser(r.subject).then(function(t){n.model.user=t},u.errorHandler)}var u=new i;n.feedback=u;n.model={};f();n.setPassword=function(n,i,r){i===r?t.setPassword(n,i).then(function(){u.message="Password Changed"},u.errorHandler):u.errors="Password and Confirmation do not match"};n.setEmail=function(n,i){t.setEmail(n,i).then(u.createMessageHandler("Email Changed"),u.errorHandler)};n.setPhone=function(n,i){t.setPhone(n,i).then(u.createMessageHandler("Phone Changed"),u.errorHandler)};n.addClaim=function(n,i,r){t.addClaim(n,i,r).then(function(){u.message="Claim Added";f()},u.errorHandler)};n.removeClaim=function(n,i,r){t.removeClaim(n,i,r).then(function(){u.message="Claim Removed";f()},u.errorHandler)};n.deleteUser=function(i){t.deleteUser(i).then(function(){u.message="User Deleted";n.model.user=null},u.errorHandler)}}var t=n.module("app",["ngRoute","ttIdm"]);r.$inject=["$routeProvider","PathBase"];t.config(r);u.$inject=["PathBase"];t.directive("idmMessage",u);f.$inject=["$scope","idmCurrentUser"];t.controller("LayoutCtrl",f);e.$inject=["$scope"];t.controller("HomeCtrl",e);o.$inject=["$scope","idmUsers","$sce","$routeParams","$location"];t.controller("ListUsersCtrl",o);s.$inject=["$scope","idmUsers"];t.controller("NewUserCtrl",s);h.$inject=["$scope","idmUsers","$routeParams"];t.controller("EditUserCtrl",h)}(angular),function(){var n=document.getElementById("pathBase").textContent;angular.module("ttIdm").constant("PathBase",n)}();
/*
//# sourceMappingURL=app.min.js.map
*/