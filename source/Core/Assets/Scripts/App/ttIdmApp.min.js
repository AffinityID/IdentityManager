(function(n){function i(){var n=this,t,i;n.clear=function(){t=null;i=null};Object.defineProperty(this,"message",{get:function(){return i},set:function(t){n.clear();i=t}});Object.defineProperty(this,"errors",{get:function(){return t},set:function(i){n.clear();t=i instanceof Array?i:[i]}});n.messageHandler=function(t){n.message=t};n.errorHandler=function(t){n.errors=t};n.createMessageHandler=function(t){return function(){n.message=t}};n.createErrorHandler=function(t){return function(i){n.errors=i||t}}}function r(n,t){n.when("/",{controller:"HomeCtrl",templateUrl:t+"/assets/Templates.home.html"}).when("/users/list/:filter?/:page?",{controller:"ListUsersCtrl",resolve:{api:"idmUsers"},templateUrl:t+"/assets/Templates.users.list.html"}).when("/users/create",{controller:"NewUserCtrl",resolve:{api:"idmUsers"},templateUrl:t+"/assets/Templates.users.new.html"}).when("/users/edit/:subject",{controller:"EditUserCtrl",resolve:{api:"idmUsers"},templateUrl:t+"/assets/Templates.users.edit.html"}).otherwise({redirectTo:"/"})}function u(n,t){n.model={};t.then(function(){n.model.username=t.data.currentUser.username;n.model.links=t.links})}function f(n){n.model={}}function e(n,t,i,r,u){var e={message:null,users:null,pager:null,waiting:!0,filter:r.filter,page:r.page||1},f,o;n.model=e;n.search=function(n){var t="/users/list";n&&(t+="/"+n);u.url(t)};f=10;o=(e.page-1)*f;t.getUsers(e.filter,o,f).then(function(t){n.model.waiting=!1;n.model.users=t.data.users;t.data.users&&t.data.users.length&&(n.model.pager=new i(t.data,f))},function(t){n.model.message=t;n.model.waiting=!1})}function o(n,t,r){var u=new i,f;if(n.feedback=u,r.data.metadata.userMetadata.supportsCreate)f=r.data.metadata.userMetadata.properties.filter(function(n){return n.required&&n.type!="username"&&n.type!="password"}).map(function(n){return{meta:n,data:undefined}}),n.properties=f,n.create=function(i,r,f){var e=f.map(function(n){return{type:n.meta.type,value:n.data}});t.createUser(i,r,e).then(function(t){n.model.last=t;u.message="Create Success"},u.errorHandler)};else{u.errors="Create Not Supported";return}}function s(n,t,r){function f(){return t.getUser(r.subject).then(function(t){n.user=t},u.errorHandler)}var u=new i;n.feedback=u;f();n.setProperty=function(n){t.setProperty(n).then(function(){u.message=n.meta.name+" Changed to: "+n.data;f()},u.errorHandler)};n.addClaim=function(n,i){t.addClaim(n,i).then(function(){u.message="Claim Added : "+i.type+", "+i.value;f()},u.errorHandler)};n.removeClaim=function(i){t.removeClaim(i).then(function(){u.message="Claim Removed : "+i.data.type+", "+i.data.value;f().then(function(){n.claim=i.data})},u.errorHandler)};n.deleteUser=function(i){t.deleteUser(i).then(function(){u.message="User Deleted";n.user=null},u.errorHandler)}}var t=n.module("ttIdmApp",["ngRoute","ttIdm","ttIdmUI"]);r.$inject=["$routeProvider","PathBase"];t.config(r);u.$inject=["$scope","idmApi"];t.controller("LayoutCtrl",u);f.$inject=["$scope"];t.controller("HomeCtrl",f);e.$inject=["$scope","idmUsers","idmPager","$routeParams","$location"];t.controller("ListUsersCtrl",e);o.$inject=["$scope","idmUsers","idmApi"];t.controller("NewUserCtrl",o);s.$inject=["$scope","idmUsers","$routeParams"];t.controller("EditUserCtrl",s)})(angular);
/*
//# sourceMappingURL=ttIdmApp.min.js.map
*/